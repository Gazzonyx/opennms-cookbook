<?xml version="1.0"?>
<!-- 24 hours -->
<capsd-configuration 
	rescan-frequency="<%=@rescan_frequency%>" 
	initial-sleep-time="<%=@initial_sleep_time%>" 
        max-suspect-thread-pool-size="<%=@max_suspect_threads%>"
         max-rescan-thread-pool-size="<%=@max_rescan_threads%>"> 

  <% if @icmp['enabled'] -%>
    <protocol-plugin protocol="ICMP" class-name="org.opennms.netmgt.capsd.plugins.IcmpPlugin" scan="<%=@icmp['scan']%>">
        <property key="timeout" value="<%=@icmp['timeout']%>" />
        <property key="retry" value="<%=@icmp['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @strafeping['enabled'] -%>
    <protocol-plugin protocol="StrafePing" class-name="org.opennms.netmgt.capsd.plugins.IcmpPlugin" scan="<%=@strafeping['scan']%>">
        <property key="timeout" value="<%=@strafeping['timeout']%>" />
        <property key="retry" value="<%=@strafeping['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @snmp['enabled'] -%>
    <protocol-plugin protocol="SNMP" class-name="org.opennms.netmgt.capsd.plugins.SnmpPlugin" scan="<%=@snmp['scan']%>">
        <property key="timeout" value="<%=@snmp['timeout']%>" />
        <property key="retry" value="<%=@snmp['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @http['enabled'] -%>
    <protocol-plugin protocol="HTTP" class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" scan="<%=@http['scan']%>">
        <property key="port" value="<%=@http['port']%>" />
        <property key="timeout" value="<%=@http['timeout']%>" />
        <property key="retry" value="<%=@http['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @http_8080['enabled'] -%>
    <protocol-plugin protocol="HTTP-8080" class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" scan="<%=@http_8080['scan']%>">
        <property key="port" value="<%=@http_8080['port']%>" />
        <property key="timeout" value="<%=@http_8080['timeout']%>" />
        <property key="retry" value="<%=@http_8080['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @http_8000['enabled'] -%>
    <protocol-plugin protocol="HTTP-8000" class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" scan="<%=@http_8000['scan']%>">
        <property key="port" value="<%=@http_8000['port']%>" />
        <property key="timeout" value="<%=@http_8000['timeout']%>" />
        <property key="retry" value="<%=@http_8000['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @https['enabled'] -%>
    <protocol-plugin protocol="HTTPS" class-name="org.opennms.netmgt.capsd.plugins.HttpsPlugin" scan="<%=@https['scan']%>">
        <property key="port" value="<%=@https['port']%>" />
        <property key="timeout" value="<%=@https['timeout']%>" />
        <property key="retry" value="<%=@https['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @hyperic_agent['enabled'] -%>
    <protocol-plugin protocol="HypericAgent" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@hyperic_agent['scan']%>">
        <property key="port" value="<%=@hyperic_agent['port']%>" />
        <property key="timeout" value="<%=@hyperic_agent['timeout']%>" />
        <property key="retry" value="<%=@hyperic_agent['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @hyperichq['enabled'] -%>
    <protocol-plugin protocol="HypericHQ" class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" scan="<%=@hyperichq['scan']%>">
        <property key="port" value="<%=@hyperichq['port']%>" />
        <property key="timeout" value="<%=@hyperichq['timeout']%>" />
        <property key="retry" value="<%=@hyperichq['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @ftp['enabled'] -%>
    <protocol-plugin protocol="FTP" class-name="org.opennms.netmgt.capsd.plugins.FtpPlugin" scan="<%=@ftp['scan']%>">
        <property key="port" value="<%=@ftp['port']%>" />
        <property key="timeout" value="<%=@ftp['timeout']%>" />
        <property key="retry" value="<%=@ftp['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @telnet['enabled'] -%>
    <protocol-plugin protocol="Telnet" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@telnet['scan']%>">
        <property key="banner" value="<%=@telnet['banner']%>" />
        <property key="port" value="<%=@telnet['port']%>" />
        <property key="timeout" value="<%=@telnet['timeout']%>" />
        <property key="retry" value="<%=@telnet['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @dns['enabled'] -%>
    <protocol-plugin protocol="DNS" class-name="org.opennms.netmgt.capsd.plugins.DnsPlugin" scan="<%=@dns['scan']%>">
        <property key="port" value="<%=@dns['port']%>" />
        <property key="timeout" value="<%=@dns['timeout']%>" />
        <property key="retry" value="<%=@dns['retry']%>" />
        <property key="lookup" value="<%=@dns['lookup']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @imap['enabled'] -%>
    <protocol-plugin protocol="IMAP" class-name="org.opennms.netmgt.capsd.plugins.ImapPlugin" scan="<%=@imap['scan']%>">
        <property key="port" value="<%=@imap['port']%>" />
        <property key="timeout" value="<%=@imap['timeout']%>" />
        <property key="retry" value="<%=@imap['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @msexchange['enabled'] -%>
    <protocol-plugin protocol="MSExchange" class-name="org.opennms.netmgt.capsd.plugins.MSExchangePlugin" scan="<%=@msexchange['scan']%>">
        <property key="pop3 port" value="<%=@msexchange['pop3_port']%>" />
        <property key="imap port" value="<%=@msexchange['imap_port']%>" />
        <property key="mapi port" value="<%=@msexchange['mapi_port']%>" />
        <property key="timeout" value="<%=@msexchange['timeout']%>" />
        <property key="retry" value="<%=@msexchange['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @smtp['enabled'] -%>
    <protocol-plugin protocol="SMTP" class-name="org.opennms.netmgt.capsd.plugins.SmtpPlugin" scan="<%=@smtp['scan']%>">
        <property key="port" value="<%=@smtp['port']%>" />
        <property key="timeout" value="<%=@smtp['timeout']%>" />
        <property key="retry" value="<%=@smtp['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @pop3['enabled'] -%>
    <protocol-plugin protocol="POP3" class-name="org.opennms.netmgt.capsd.plugins.Pop3Plugin" scan="<%=@pop3['scan']%>">
        <property key="port" value="<%=@pop3['port']%>" />
        <property key="timeout" value="<%=@pop3['timeout']%>" />
        <property key="retry" value="<%=@pop3['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @ssh['enabled'] -%>
    <protocol-plugin protocol="SSH" class-name="org.opennms.netmgt.capsd.plugins.SshPlugin" scan="<%=@ssh['scan']%>">
        <property key="banner" value="<%=@ssh['banner']%>" />
        <property key="port" value="<%=@ssh['port']%>" />
        <property key="timeout" value="<%=@ssh['timeout']%>" />
        <property key="retry" value="<%=@ssh['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @mysql['enabled'] -%>
    <protocol-plugin protocol="MySQL" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@mysql['scan']%>">
        <property key="banner" value="<%=@mysql['banner']%>" />
        <property key="port" value="<%=@mysql['port']%>" />
        <property key="timeout" value="<%=@mysql['timeout']%>" />
        <property key="retry" value="<%=@mysql['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @sqlserver['enabled'] -%>
    <protocol-plugin protocol="SQLServer" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@sqlserver['scan']%>">
        <property key="banner" value="<%=@sqlserver['banner']%>" />
        <property key="port" value="<%=@sqlserver['port']%>" />
        <property key="timeout" value="<%=@sqlserver['timeout']%>" />
        <property key="retry" value="<%=@sqlserver['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @oracle['enabled'] -%>
    <protocol-plugin protocol="Oracle" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@oracle['scan']%>">
        <property key="banner" value="<%=@oracle['banner']%>" />
        <property key="port" value="<%=@oracle['port']%>" />
        <property key="timeout" value="<%=@oracle['timeout']%>" />
        <property key="retry" value="<%=@oracle['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @postgres['enabled'] -%>
    <protocol-plugin protocol="Postgres" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@postgres['scan']%>">
        <property key="banner" value="<%=@postgres['banner']%>" />
        <property key="port" value="<%=@postgres['port']%>" />
        <property key="timeout" value="<%=@postgres['timeout']%>" />
        <property key="retry" value="<%=@postgres['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @router['enabled'] -%>
    <protocol-plugin protocol="Router" class-name="org.opennms.netmgt.capsd.plugins.SnmpPlugin" scan="<%=@router['scan']%>">
        <property key="vbname" value="<%=@router['vbname']%>" />
        <property key="vbvalue" value="<%=@router['vbvalue']%>" />
        <property key="timeout" value="<%=@router['timeout']%>" />
        <property key="retry" value="<%=@router['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @hp_insight_manager['enabled'] -%>
    <protocol-plugin protocol="HP Insight Manager" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@hp_insight_manager['scan']%>">
        <property key="banner" value="<%=@hp_insight_manager['banner']%>" />
        <property key="port" value="<%=@hp_insight_manager['port']%>" />
        <property key="timeout" value="<%=@hp_insight_manager['timeout']%>" />
        <property key="retry" value="<%=@hp_insight_manager['retry']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @dell_openmanage['enabled'] -%>
    <protocol-plugin protocol="Dell-OpenManage" class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" scan="<%=@dell_openmanage['scan']%>">
        <property key="banner" value="<%=@dell_openmanage['banner']%>" />
        <property key="port" value="<%=@dell_openmanage['port']%>" />
        <property key="timeout" value="<%=@dell_openmanage['timeout']%>" />
        <property key="retry" value="<%=@dell_openmanage['retry']%>" />
    </protocol-plugin>    
  <% end -%>
  <% if @nrpe['enabled'] -%>
    <protocol-plugin protocol="NRPE" class-name="org.opennms.netmgt.capsd.plugins.NrpePlugin" scan="<%=@nrpe['scan']%>">
        <property key="banner" value="<%=@nrpe['banner']%>" />
        <property key="port" value="<%=@nrpe['port']%>" />
        <property key="timeout" value="<%=@nrpe['timeout']%>" />
        <property key="retry" value="<%=@nrpe['retry']%>" />
        <property key="command" value="<%=@nrpe['command']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @nrpe_nossl['enabled'] -%>
    <protocol-plugin protocol="NRPE-NoSSL" class-name="org.opennms.netmgt.capsd.plugins.NrpePlugin" scan="<%=@nrpe_nossl['scan']%>">
        <property key="banner" value="<%=@nrpe_nossl['banner']%>" />
        <property key="port" value="<%=@nrpe_nossl['port']%>" />
        <property key="timeout" value="<%=@nrpe_nossl['timeout']%>" />
        <property key="retry" value="<%=@nrpe_nossl['retry']%>" />
        <property key="usessl" value="<%=@nrpe_nossl['usessl']%>" />
        <property key="command" value="<%=@nrpe_nossl['command']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @windows_task_scheduler['enabled'] -%>
    <protocol-plugin protocol="Windows-Task-Scheduler" class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" scan="<%=@windows_task_scheduler['scan']%>">
        <property key="timeout" value="<%=@windows_task_scheduler['timeout']%>" />
        <property key="retry" value="<%=@windows_task_scheduler['retry']%>" />
        <property key="service-name" value="<%=@windows_task_scheduler['service_name']%>" />
    </protocol-plugin>
  <% end -%>
  <% if @opennms_jvm['enabled'] -%>
    <protocol-plugin protocol="OpenNMS-JVM" class-name="org.opennms.netmgt.capsd.plugins.Jsr160Plugin" scan="<%=@opennms_jvm['scan']%>" user-defined="false">
        <property key="port" value="<%=@opennms_jvm['port']%>" />
        <property key="factory" value="<%=@opennms_jvm['factory']%>"/>
        <property key="username" value="<%=@opennms_jvm['username']%>" />
        <property key="password" value="<%=@opennms_jvm['password']%>" />
        <property key="protocol" value="<%=@opennms_jvm['protocol']%>"/>
        <property key="urlPath" value="<%=@opennms_jvm['url_path']%>"/>
        <property key="timeout" value="<%=@opennms_jvm['timeout']%>" />
        <property key="retry" value="<%=@opennms_jvm['retry']%>" />
        <property key="type" value="<%=@opennms_jvm['type']%>" />
    </protocol-plugin>
  <% end -%>
</capsd-configuration>
